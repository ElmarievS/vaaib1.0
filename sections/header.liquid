<div data-section-id="{{ section.id }}" data-section-type="header">
  {% if section.settings.enable_announcement %}
    <div class="announcement-bar" style="background-color: {{ section.settings.announcement_bg }}">
      <div class="container">
        <p class="announcement-text" style="color: {{ section.settings.announcement_color }}">
          {{ section.settings.announcement_text }}
        </p>
      </div>
    </div>
  {% endif %}

  <header class="site-header{% if section.settings.enable_sticky %} sticky{% endif %}">
    <div class="container">
      <div class="header-wrapper">
        <!-- Logo -->
        <div class="header-logo{% if section.settings.center_logo %} header-logo--center{% endif %}">
          {% if template.name == 'index' %}
            <h1 class="header-logo__heading">
          {% else %}
            <div class="header-logo__heading">
          {% endif %}
              
          <a href="/" class="header-logo__link">
            {% if section.settings.logo != blank %}
              {% assign image_size = section.settings.logo_max_width | append: 'x' %}
              <img src="{{ section.settings.logo | img_url: image_size }}"
                   alt="{{ section.settings.logo.alt | default: shop.name }}"
                   width="{{ section.settings.logo_max_width }}"
                   {% if settings.enable_lazy_loading %}loading="lazy"{% endif %}>
            {% else %}
              {{ shop.name }}
            {% endif %}
          </a>

          {% if template.name == 'index' %}
            </h1>
          {% else %}
            </div>
          {% endif %}
        </div>

        <!-- Navigation -->
        <nav class="header-nav" role="navigation">
          {% if section.settings.menu != blank %}
            <ul class="nav-menu">
              {% for link in linklists[section.settings.menu].links %}
                <li class="nav-menu__item{% if link.links.size > 0 %} has-dropdown{% endif %}">
                  <a href="{{ link.url }}" class="nav-menu__link">{{ link.title }}</a>
                  {% if link.links.size > 0 and section.settings.enable_mega_menu %}
                    <div class="mega-menu">
                      <ul>
                        {% for childlink in link.links %}
                          <li><a href="{{ childlink.url }}">{{ childlink.title }}</a></li>
                        {% endfor %}
                      </ul>
                    </div>
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          {% endif %}
        </nav>

        <!-- Header Actions -->
        <div class="header-actions">
          {% if section.settings.enable_search %}
            <div class="header-search">
              <button type="button" class="search-toggle" aria-label="Toggle search">
                {% render 'icon-search' %}
              </button>
              <div class="search-popup">
                <form action="/search" method="get" class="search-form">
                  <input type="search" 
                         name="q" 
                         placeholder="{{ 'general.search.placeholder' | t }}"
                         aria-label="{{ 'general.search.placeholder' | t }}">
                  <button type="submit">{{ 'general.search.submit' | t }}</button>
                </form>
              </div>
            </div>
          {% endif %}

          {% if section.settings.enable_account %}
            <div class="header-account">
              {% if customer %}
                <a href="/account" class="account-link">
                  {% render 'icon-account' %}
                  {% if section.settings.show_account_label %}
                    <span>{{ 'customer.account.title' | t }}</span>
                  {% endif %}
                </a>
              {% else %}
                <a href="/account/login" class="account-link">
                  {% render 'icon-account' %}
                  {% if section.settings.show_account_label %}
                    <span>{{ 'customer.login.title' | t }}</span>
                  {% endif %}
                </a>
              {% endif %}
            </div>
          {% endif %}

          {% if section.settings.enable_cart %}
            <div class="header-cart">
              <button type="button" 
                      class="cart-toggle{% if section.settings.enable_cart_drawer %} cart-drawer-toggle{% endif %}"
                      aria-label="Toggle cart">
                {% render 'icon-cart' %}
                {% if section.settings.show_cart_count %}
                  <span class="cart-count">{{ cart.item_count }}</span>
                {% endif %}
              </button>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </header>
</div>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "header",
      "content": "üé® Layout & Design",
      "info": "Customize your header's appearance"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_max_width",
      "min": 50,
      "max": 300,
      "step": 10,
      "unit": "px",
      "label": "Logo width",
      "default": 200
    },
    {
      "type": "checkbox",
      "id": "center_logo",
      "label": "Center logo",
      "default": false
    },
    {
      "type": "header",
      "content": "üì¢ Announcement Bar",
      "info": "Add a promotional message"
    },
    {
      "type": "checkbox",
      "id": "enable_announcement",
      "label": "Show announcement bar",
      "default": false
    },
    {
      "type": "text",
      "id": "announcement_text",
      "label": "Announcement text",
      "default": "Announce something here"
    },
    {
      "type": "color",
      "id": "announcement_bg",
      "label": "Background color",
      "default": "#1B3651"
    },
    {
      "type": "color",
      "id": "announcement_color",
      "label": "Text color",
      "default": "#FFFFFF"
    },
    {
      "type": "header",
      "content": "‚ö° Features",
      "info": "Configure header functionality"
    },
    {
      "type": "checkbox",
      "id": "enable_sticky",
      "label": "Enable sticky header",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_mega_menu",
      "label": "Enable mega menu",
      "default": false
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "header",
      "content": "üîç Search",
      "info": "Configure search options"
    },
    {
      "type": "checkbox",
      "id": "enable_search",
      "label": "Enable search",
      "default": true
    },
    {
      "type": "header",
      "content": "üë§ Account",
      "info": "Configure account display"
    },
    {
      "type": "checkbox",
      "id": "enable_account",
      "label": "Show account icon",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_account_label",
      "label": "Show account text",
      "default": false
    },
    {
      "type": "header",
      "content": "üõí Cart",
      "info": "Configure cart display"
    },
    {
      "type": "checkbox",
      "id": "enable_cart",
      "label": "Show cart icon",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_cart_drawer",
      "label": "Enable cart drawer",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_cart_count",
      "label": "Show cart count",
      "default": true
    }
  ]
}
{% endschema %}
